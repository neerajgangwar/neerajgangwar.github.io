<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Neeraj Gangwar | Face Recognition </title> <meta name="description" content="Homepage of Neeraj Gangwar. Based on [*folio](https://github.com/bogoli/-folio) design. "> <!-- Open Graph --> <meta property="og:site_name" content="Homepage of Neeraj Gangwar. Based on [*folio](https://github.com/bogoli/-folio) design. " /> <meta property="og:type" content="object" /> <meta property="og:title" content="" /> <meta property="og:url" content="https://neerajgangwar.com/blog/2013/face-recognition/" /> <meta property="og:description" content="Face Recognition" /> <meta property="og:image" content="" /> <!-- Bootstrap & MDB --> <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" /> <!-- Fonts & Icons --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <!-- Styles --> <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ng</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="/blog/2013/face-recognition/"> <!-- JQuery --> <!-- jQuery --> <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script> <!-- Theming--> <!-- MathJax --> <script type="text/javascript"> window.MathJax = { tex: { tags: 'ams' } }; </script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </head> <body class="fixed-top-nav "> <!-- Header --> <header> <!-- Nav Bar --> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://neerajgangwar.com/"> Neeraj Gangwar </a> <!-- Navbar Toggle --> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <!-- About --> <li class="nav-item "> <a class="nav-link" href="/"> about </a> </li> <!-- Blog --> <li class="nav-item active"> <a class="nav-link" href="/blog/"> blog </a> </li> <!-- Other pages --> <li class="nav-item "> <a class="nav-link" href="/publications/"> publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/resume/"> resume </a> </li> </ul> </div> </div> </nav> </header> <!-- Content --> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Face Recognition</h1> <p class="post-meta">December 23, 2013 â€¢ Neeraj Gangwar</p> </header> <article class="post-content"> <p> This post is not going to be about compressive sensing or sparse representation. I have been trying to find a field where I can use either of these approaches. I read that sparse representation can be used in face recognition. Well, I am still not sure. I am working on its validity. In the meantime, I tried to implement basic face recognition system. </p> <p> I read <a href="http://www.face-rec.org/algorithms/PCA/jcn.pdf" target="_blank">Eigenfaces for Recognition</a>&nbsp;by Matthew Turk and Alex Pentland. It's a very basic face recognition approach. </p> <p> There are two modules. First module is to train the system. It takes a set of faces and generates the features (called eigenfaces) and weight vectors (or projections). The second module is for face matching. It uses these features to calculate the weight vectors for a new image and decides the face class for this new face. </p> <p><br /></p> <h4>Approach</h4> <ol> <li> Principal Component Analysis (PCA) is used in this approach to reduce the dimensionality of the data. <a href="http://www.stat.cmu.edu/~cshalizi/490/pca/pca-handout.pdf" target="_blank"> Here</a> is a good tutorial on PCA. </li> <li> Suppose we have \(M\) images of size \( N \times N \). These images are reshaped into a \( N^2 \times 1 \) vectors \( \Gamma_1, \Gamma_2 \dots \Gamma_M\). Now our aim is to summarize them by projecting into a \(M'\) dimensional subspace \( M' \le M \). </li> <li> PCA gives an orthonormal basis for \( M \) dimensional subspace \( \mathbf{u}_k \). This basis is named as eigenfaces. </li> <li> Original images are transformed into its eigenfaces components (weights) using $$ \omega_k = &nbsp;\mathbf{u}_k( \Gamma - \Psi) $$ where $$ \Psi = \frac{1}{M} \sum_{n=1}^{M} \; \Gamma_n$$ The reason to introduce \( \Psi \) is to make the data zero mean. More details are given in the tutorial mentioned above. </li> <li> A face class (or weight vectors) is defined as \( \Omega = [\omega_1, \omega_2 \dots \omega_M] \) for each individual face. We generally take average weight of these weight vectors for different images of the same face to define a face class. </li> </ol> <p><br /></p> <h4>Few original faces</h4> <p>I used 400 images. 10 per person.</p> <div style="text-align: center;"> <img border="0" src="http://4.bp.blogspot.com/-qgqly2LpSUM/UrkWmOMu2cI/AAAAAAAAAd4/-_5cGhzalZM/s640/Screenshot+from+2013-12-24+10:36:55.png" height="416" width="640" /> </div> <p><br /></p> <h4>Few Eigenfaces</h4> <p> Actually there are 400 of them since I used 400 images. But I used only 200 corresponding to 200 largest eigenvalues (sufficient to represent original images with tolerable amount of error). </p> <div style="text-align: center;"> <img border="0" src="http://4.bp.blogspot.com/-py9JWa3nefE/UrkVtzvYWjI/AAAAAAAAAdw/QKeXDciGiSM/s640/Screenshot+from+2013-12-24+10:32:08.png" height="417" width="640" /> </div> <p><br /></p> <h4>Face Matching</h4> <p> It's really simple. We just have to calculate weight vector for the new face and compare with those of original images to find out the closest face. This way we find out the face class for a new face. An error threshold is also defined to ensure that the new image does belong to a particular face class in addition to being closest to it. </p> <p><br /></p> <h4>Testing</h4> <p> I used first 9 images of each individual face to train the system i.e. 360 images. I gave 10th face as input to face matching. See the plot for error (minimum value of error corresponds to closest face class) </p> <p><br /></p> <h5>For 10th image of 1st face class</h5> <div style="text-align: center;"> <img border="0" src="http://4.bp.blogspot.com/-tZp_KpQkGwY/Urkb6oLchrI/AAAAAAAAAeI/1deNtIUvoKQ/s640/Screenshot+from+2013-12-24+10:58:28.png" height="499" width="640" /> </div> <p>It can be seen that height of first bar is minimum.</p> <p><br /></p> <h5>For 10th image of 8th face class</h5> <div style="text-align: center;"> <img border="0" src="http://1.bp.blogspot.com/-vOp4MEcp4IQ/Urkb8pY1TXI/AAAAAAAAAeQ/cvstEQYUBTI/s640/Screenshot+from+2013-12-24+10%253A58%253A41.png" height="488" width="640" /> </div> <p>Here height of 8th bar is minimum corresponding to minimum error.</p> <p><br /></p> <p> My code can be found <a href="https://github.com/neerajgangwar/Face-Recognition" target="_blank">here</a>. Code is not structured but it'll give you a basic idea about how to write your own. </p> <p> Face database is available <a href="http://www.cl.cam.ac.uk/research/dtg/attarchive/facedatabase.html" target="_blank"> here</a>. </p> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> </article> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'neerajgangwar'; var disqus_identifier = '/blog/2013/face-recognition'; var disqus_title = "Face Recognition"; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> </div> <!-- Footer --> <footer class="fixed-bottom"> <div class="container mt-0"> &copy; Copyright 2023 Neeraj Gangwar. Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>. Last updated: March 29, 2023. </div> </footer> <script data-goatcounter="https://neerajgangwar.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script> </body> <!-- Bootsrap & MDB scripts --> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script> <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script> <!-- Mansory & imagesLoaded --> <script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script> <script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/mansory.js" type="text/javascript"></script> <!-- Medium Zoom JS --> <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script src="/assets/js/zoom.js"></script> <!-- Load Common JS --> <script src="/assets/js/common.js"></script> </html>
